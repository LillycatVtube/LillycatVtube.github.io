<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="author" content="WindySprings">
	<meta name="description" content="Site of Winds of Spring System">

	<title>Windy Springs Page: Chatroom</title>
	<link rel="icon" href="siteicon.png" type="image/x-icon">
	<link rel="stylesheet" href="main.css">
  <style>
      #form { background: rgba(0, 0, 0, 0.15); padding: 0.25rem; position: fixed; bottom: 0; left: 0; right: 0; display: flex; height: 3rem; box-sizing: border-box; backdrop-filter: blur(10px); }
      #input { border: none; padding: 0 1rem; flex-grow: 1; border-radius: 2rem; margin: 0.25rem; }
      #input:focus { outline: none; }
      #form > button { background: #333; border: none; padding: 0 1rem; margin: 0.25rem; border-radius: 3px; outline: none; color: #bcbcbc; }

      #messages { list-style-type: none; margin: 0; padding: 2em; }
      #messages > li { padding: 0.5rem 1rem; }
      #messages > li { background: #151433; }
    </style>
</head>




<body>

	<h1 style="text-align: center;">--Winds of Spring: Chatroom!--</h1>
	<br>
	<hr>
	<br>
	<section class="container">
          <div class="box"><abbr title="Home"><a href="index.html">Home</a></abbr></div>
          <div class="box"><abbr title="Game Dev"><a href="projects.html">Game Dev</a></abbr></div>
          <div class="box"><abbr title="Art (Pixel Art)"><a href="pixelart.html">Pixel Art</a></abbr></div>
          <div class="box"><abbr title="Art (Drawn Art)"><a href="drawnart.html">Drawn Art</a></abbr></div>
          <div class="box"><abbr title="Chatroom"><a href="chatroom.html">Chatroom</a></abbr></div>
    </section>
    <br>
    <hr>
    <br>
		<h2 style="text-align: center;">-Live Chatroom Rules!-</h2>
		<ul id=":3" style="text-align: center;">
          <li>1. No Hatespeech/toxic behaviour.</li>
          <li>2. Please don't spam.</li>
          <li>3. Respect bounderies of others.</li>
          <li>4. The chat will be cleared when leaving and re-entering/refreshing the page.</li>
        </ul>
    <br>
	<hr>
	<br>

  
		<h2 style="text-align: center;">-The Chatroom-</h2>
    <br>
    <div><ul id="messages"></ul></div>
    <form style="text-align: center;" id="form" action="">
      <input id="input" autocomplete="off" /><button>Send</button>
      <input id="username-change" placeholder="username" /><button>submit</button>
    </form>

  <script src="https://cdn.socket.io/4.8.3/socket.io.min.js"></script>
  <script>
    const socket = io();

    const form = document.getElementById('form');
    const input = document.getElementById('input');
    const messages = document.getElementById('messages');
    const name = document.getElementById('username-change');
    appendMessage('You have joined!');
    socket.emit('new-user', name.value);
    
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      if (name.value){
        socket.emit('user-changed', name.value);
      }
    });
    
    
     

      socket.on('chat message', (msg) => {
      appendMessage(`${msg.username}: ${msg.message}`);
      });

      


      socket.on('user-connected', name.value);
       form.addEventListener('submit', (e) => {
      e.preventDefault();
      if (input.value) {
        appendMessage(`${name.value}: ${input.value}`);
        socket.emit('chat message', input.value);
        
        input.value = '';
        }
      });
    function appendMessage(message) {
      const messageElement = document.createElement('li');
      messageElement.textContent = message;
      messages.appendChild(messageElement);
      window.scrollTo(0, document.body.scrollHeight);
      };

    
  </script>
</body>
</html>
